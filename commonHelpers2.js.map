{"version":3,"file":"commonHelpers2.js","sources":["../src/js/reload.js","../src/img/isEmpty.png","../src/img/isEmpty2x.png","../src/js/shopping-list.js"],"sourcesContent":["\"use strict\";\n\nwindow.addEventListener('resize', (e) => {\n    e.preventDefault();\n    \n    const windowWidth = window.innerWidth;\n    if (windowWidth === 1440) {\n        location.reload();\n    } else if (windowWidth === 768) {\n        location.reload();\n    }\n});\n","export default \"__VITE_ASSET__BrYSgzto__\"","export default \"__VITE_ASSET__C0WP04Bc__\"","\"use strict\";\nimport axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport {getMapFromLocalStorage, updateLocalStorage, updateArrayMap} from \"./local-storage.js\";\nimport {createSupportUkraine} from \"./support-ukraine.js\";\nimport {scrollUp} from \"./scroll-up.js\";\nimport \"./reload.js\";\nimport sprite from \"../img/blocks.svg\";\nimport empty from \"../img/isEmpty.png\";\nimport empty2x from \"../img/isEmpty2x.png\";\nimport '../js/header.js';\n\nconst listBooks = document.querySelector(\".list-books\");\nconst ulPagination = document.querySelector('.pagination');\nconst loadingIndicator = document.querySelector(\".container-loader\");\nconst spanCounter = document.querySelectorAll('.span-counter');\n\n// local storage\nlet arrayBooksShop = getMapFromLocalStorage();\n//\nsetSpanCounter();\n\nwindow.addEventListener(\"load\", async (e) => {\n    e.preventDefault();\n    \n    createSupportUkraine();\n    addColorLastWord(\"Shopping List\");\n\n    if (isEmpty()) {\n        await createSubArray(0, getPerPage());\n        showPagination();\n    } else {\n        listBooks.innerHTML = `\n        <div class=\"empty-shop-list\">\n            <p class=\"commentary-shop-list\">This page is empty, add some books and proceed to order.</p>\n            <img src=\"${empty}\" srcset=\"${empty2x}\" alt=\"Empty booklist\">\n        </div>`;\n        ulPagination.innerHTML = \"\";\n    }\n});\n\nlistBooks.addEventListener(\"click\", async (e) => {\n\n    if (e.target.matches('.icon-shop-list')) {\n        arrayBooksShop.delete(e.target.getAttribute('data-book'));\n\n        updateLocalStorage(arrayBooksShop); \n        updateArrayMap(arrayBooksShop);\n\n        if (isEmpty()) {\n            await createSubArray(0, getPerPage());\n            showPagination();\n        } else {\n            listBooks.innerHTML = `\n            <div class=\"empty-shop-list\">\n                <p class=\"commentary-shop-list\">This page is empty, add some books and proceed to order.</p>\n                <img src=\"${empty}\" srcset=\"${empty2x}\" alt=\"Empty booklist\">\n            </div>`;\n            ulPagination.innerHTML = \"\";\n        }\n    }\n});\n\nulPagination.addEventListener(\"click\", async (e) => {\n    e.preventDefault();\n\n    const targetElement = e.target.closest('.ul-li-container');\n    if (targetElement) {\n        let perPage = getPerPage();\n        let startIndex, pageActive;\n        const pageOne = document.querySelector('.page-one');\n        const pageText = parseInt(pageOne.textContent);\n        const sizeMap = arrayBooksShop.size;\n        const page = Math.floor(sizeMap / perPage);\n        const totalElements = document.querySelectorAll('.page-li-pagination').length;\n\n        try {\n            switch (targetElement.id) {\n                case \"start\":\n                    startIndex = 0;\n                    pageActive = 1;\n                    break;\n                case \"prev\":\n                    startIndex = (pageText - 1) * perPage - perPage;\n                    pageActive = pageText - 1;\n                    break;\n                case \"last\":\n                    if (sizeMap % perPage === 0) {\n                        startIndex = (page -1) * perPage;\n                    } else {\n                        startIndex = sizeMap - (sizeMap - (page * perPage));\n                    }\n                    pageActive = totalElements;\n                    break;\n                case \"next\":\n                    startIndex = pageText * perPage;\n                    pageActive = pageText + 1;\n                    break;\n                default:\n                    startIndex = (parseInt(e.target.textContent) -1) * perPage;\n                    pageActive = parseInt(e.target.textContent);\n            }\n            if (pageActive <= 0) throw new Error(\"This is the first page.\");\n            else if (pageText === pageActive)  throw new Error(\"Action repeated.\");\n            else if (pageActive > totalElements)  throw new Error(\"This is the last page.\");\n\n            pageOne.classList.toggle('page-one');\n            document.getElementById(pageActive.toString()).classList.add('page-one');\n            let endIndex = startIndex + perPage;\n            \n            scrollUp();\n\n            createSubArray(startIndex, endIndex);\n            hiddenLiPagination(pageActive-1);\n        } catch (error) {\n            iziToast.error({\n                title: \"Error\",\n                message: error.message,\n            });\n        }\n    }\n});\n\nasync function createSubArray(startIndex, endIndex) {\n    \n    loadingIndicator.style.display = \"block\";\n    const arraySubset = Array.from(arrayBooksShop.values()).slice(startIndex, endIndex);\n    let booksCard = ``;\n    \n    for (let value of arraySubset) {\n        booksCard += await showBooksInShoppingList(value);\n    }\n    \n    listBooks.innerHTML = booksCard;\n    loadingIndicator.style.display = \"none\";\n}\n\nasync function showPagination() {\n    const sizeMap = arrayBooksShop.size;\n    let perPage = getPerPage();\n    const page = sizeMap / perPage;\n    \n    let booksCard = `\n        <ul class=\"svg-li-pagination-container\">\n            <li class=\"svg-li-pagination-l ul-li-container\" id=\"start\">\n                <svg class=\"icon-pagination\" fill=\"none\">\n                    <use href=\"${sprite}#double-arrow\"></use>\n                </svg>\n            </li>\n            <li class=\"svg-li-pagination-l ul-li-container\" id=\"prev\">\n                <svg class=\"icon-pagination\" fill=\"none\">\n                    <use href=\"${sprite}#arr\"></use>\n                </svg>\n            </li>\n        </ul> \n        \n        <ul class=\"li-pagination-container ul-li-container\">`;\n\n            if (sizeMap > perPage) {\n                booksCard += `<li id=\"1\" class=\"page-li-pagination page-one\">1</li>`;\n                if (sizeMap % perPage === 0) {\n                    for(let i = 2; i <= page; i++) {\n                        booksCard += `<li id=\"${i}\" class=\"page-li-pagination\">${i}</li>`;\n                    };\n                } else {\n                    for(let i = 2; i <= page+1; i++) {\n                        booksCard += `<li id=\"${i}\" class=\"page-li-pagination\">${i}</li>`;\n                    };\n                }\n                \n            } else {\n                booksCard += `<li id=\"1\" class=\"page-li-pagination page-one\">1</li>`;\n            }\n\n    booksCard += `\n            <li id=\"next\" class=\"page-li-pagination-hidden-el-r ul-li-container\"></li>\n        </ul>\n        \n        <ul class=\"svg-li-pagination-container\">\n            <li class=\"svg-li-pagination-r ul-li-container\" id=\"next\">\n                <svg class=\"icon-pagination\" fill=\"none\">\n                    <svg class=\"icon-pagination\" fill=\"none\">\n                        <use href=\"${sprite}#arr\"></use>\n                    </svg>\n                </svg>\n            </li>\n            <li class=\"svg-li-pagination-r last ul-li-container\" id=\"last\">\n                <svg class=\"icon-pagination\" fill=\"none\">\n                    <use href=\"${sprite}#double-arrow\"></use>\n                </svg>\n            </li>\n        </ul>`;\n        ulPagination.innerHTML = booksCard;\n        hiddenLiPagination(0);\n        ulPagination.style.display = \"flex\";\n}\n\nasync function hiddenLiPagination(startElement) {\n    const distance = getWidthWindow();\n    document.querySelectorAll('.page-li-pagination').forEach((element, index) => {\n\n        if (index < startElement - distance || index > startElement + distance) {\n            element.style.display = \"none\";\n        } else {\n            element.style.display = \"flex\";\n        }\n    });\n\n    const totalElements = document.querySelectorAll('.page-li-pagination').length - 1;\n    \n    if (startElement < totalElements - distance) {\n        document.querySelector('.page-li-pagination-hidden-el-r').style.display = \"flex\";\n        document.querySelector('.page-li-pagination-hidden-el-r').innerHTML = \"...\";\n    } else {\n        document.querySelector('.page-li-pagination-hidden-el-r').style.display = \"none\";\n    }\n}\n\nasync function showBooksInShoppingList(book_id) {\n    try {\n        const response = await axios.get(`https://books-backend.p.goit.global/books/${book_id}`);\n        const data = response.data;\n\n        let booksCard = `\n            <li class=\"list-books-shop-list\">\n                <div>\n                    <img class=\"image-shop-list\" src=\"${data.book_image}\" alt=\"${data.title}\">\n                </div>\n\n                <div class=\"main-container-shop-list\">\n                    <div class=\"text-content-shop-list\">\n                        <div class=\"top-content-shop-list\">\n                            <div class=\"text-book-container\">\n                                <p class=\"title\">${data.title}</p>\n                                <p class=\"list-name\">${data.list_name}</p>\n                            </div>\n\n                                <svg class=\"icon-shop-list\" fill=\"none\">\n                                    <use data-book=\"${data.title}\" class=\"icon-shop-list\" href=\"${sprite}#block\"></use>\n                                </svg>\n                        </div>\n\n                        <p class=\"description-shop-list\">${data.description}</p>\n                    </div>\n\n                    <div class=\"author-links-shop-list\">\n                        <p class=\"author\">${data.author}</p>\n                        <div class=\"link-container-shop-list\">\n                            <a href=\"${data.buy_links[0].url}\" target=\"_blank\">\n                                <img src=\"../img/amazon.png\" srcset=\"../img/amazon.png 1x, ../img/amazon2x.png 2x\" alt=\"amazon\"></img>\n                            </a>\n                            <a href=\"${data.buy_links[1].url}\" target=\"_blank\">\n                                <img src=\"../img/book.png\" srcset=\"../img/book.png 1x, ../img/book2x.png 2x\" alt=\"book\"></img>\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            </li>`;\n        return booksCard;\n    } catch (error) {\n        iziToast.error({\n            title: \"Error\",\n            message: error.message,\n        });\n    }\n}\n\nasync function addColorLastWord (word) {\n    const lastSpaceIndex = word.lastIndexOf(' ');\n    const nameCategory = document.querySelector(\".name-page\");\n    nameCategory.innerHTML = `${word.substring(0, lastSpaceIndex)} <span class=\"blue-color\">${word.substring(lastSpaceIndex + 1)}</span>`;\n}\n\nfunction getWidthWindow() {\n    const width = window.innerWidth;\n    if (width <= 767) return 1;\n    else return 2;\n}\n\nfunction getPerPage() {\n    if (getWidthWindow() === 2) {\n        return 5;\n    } else {\n        return 3;\n    }\n}\n\nfunction isEmpty() {\n    return arrayBooksShop.size !== 0;\n}\n\nasync function setSpanCounter() {\n    spanCounter.forEach( async (element) => {\n        element.textContent = arrayBooksShop.size;\n        if (!arrayBooksShop.size) element.style.display = \"none\";\n    });\n}"],"names":["windowWidth","empty","empty2x","listBooks","ulPagination","loadingIndicator","spanCounter","arrayBooksShop","getMapFromLocalStorage","setSpanCounter","createSupportUkraine","addColorLastWord","isEmpty","createSubArray","getPerPage","showPagination","updateLocalStorage","updateArrayMap","targetElement","perPage","startIndex","pageActive","pageOne","pageText","sizeMap","page","totalElements","endIndex","scrollUp","hiddenLiPagination","error","iziToast","arraySubset","booksCard","value","showBooksInShoppingList","sprite","i","startElement","distance","getWidthWindow","element","index","book_id","data","axios","word","lastSpaceIndex","nameCategory"],"mappings":"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"}